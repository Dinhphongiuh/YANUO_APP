{"ast":null,"code":"import { useEffect, useState, useMemo } from 'react';\nimport decode from './decode';\nimport { isBlurhashString } from '../resolveSources';\nconst DEFAULT_SIZE = {\n  width: 32,\n  height: 32\n};\nconst scaleRatio = 10;\nexport function useBlurhash(blurhash, punch = 1) {\n  punch = punch || 1;\n  const [uri, setUri] = useState(null);\n  useEffect(() => {\n    let isCanceled = false;\n    if (!blurhash || !blurhash.uri || !isBlurhashString(blurhash.uri)) return;\n    const pixels = decode(blurhash.uri, blurhash?.width ?? DEFAULT_SIZE.width, blurhash?.height ?? DEFAULT_SIZE.height, punch);\n    const canvas = document.createElement('canvas');\n    const upscaledCanvas = document.createElement('canvas');\n    canvas.width = blurhash?.width ?? DEFAULT_SIZE.width;\n    canvas.height = blurhash?.height ?? DEFAULT_SIZE.height;\n    upscaledCanvas.width = (blurhash?.width ?? DEFAULT_SIZE.width) * scaleRatio;\n    upscaledCanvas.height = (blurhash?.height ?? DEFAULT_SIZE.height) * scaleRatio;\n    const context = canvas.getContext('2d');\n    if (!context) {\n      console.warn('Failed to decode blurhash');\n      return;\n    }\n    const imageData = context.createImageData(canvas.width, canvas.height);\n    imageData.data.set(pixels);\n    context.putImageData(imageData, 0, 0);\n    const upscaledContext = upscaledCanvas.getContext('2d');\n    if (!upscaledContext) {\n      console.warn('Failed to decode blurhash');\n      return;\n    }\n    upscaledContext.scale(scaleRatio, scaleRatio);\n    upscaledContext.drawImage(canvas, 0, 0);\n    upscaledCanvas.toBlob(blob => {\n      if (!isCanceled) {\n        setUri(oldUrl => {\n          if (oldUrl) {\n            URL.revokeObjectURL(oldUrl);\n          }\n          return blob ? URL.createObjectURL(blob) : oldUrl;\n        });\n      }\n    });\n    return function cleanupBlurhash() {\n      isCanceled = true;\n      setUri(oldUrl => {\n        if (oldUrl) {\n          URL.revokeObjectURL(oldUrl);\n        }\n        return null;\n      });\n    };\n  }, [blurhash?.uri, blurhash?.height, blurhash?.width, punch]);\n  return useMemo(() => uri ? {\n    uri\n  } : null, [uri]);\n}","map":{"version":3,"names":["useEffect","useState","useMemo","decode","isBlurhashString","DEFAULT_SIZE","width","height","scaleRatio","useBlurhash","blurhash","punch","uri","setUri","isCanceled","pixels","canvas","document","createElement","upscaledCanvas","context","getContext","console","warn","imageData","createImageData","data","set","putImageData","upscaledContext","scale","drawImage","toBlob","blob","oldUrl","URL","revokeObjectURL","createObjectURL","cleanupBlurhash"],"sources":["C:\\Users\\DinhPhongIUH\\Desktop\\nhap\\Yanuo_mobile_Redux\\node_modules\\expo-image\\src\\utils\\blurhash\\useBlurhash.tsx"],"sourcesContent":["// adapted from https://gist.github.com/ngbrown/d62eb518753378eb0a9bf02bb4723235\n// modified from https://gist.github.com/WorldMaker/a3cbe0059acd827edee568198376b95a\n// https://github.com/woltapp/react-blurhash/issues/3\n\nimport { useEffect, useState, useMemo } from 'react';\n\nimport decode from './decode';\nimport { isBlurhashString } from '../resolveSources';\n\nconst DEFAULT_SIZE = {\n  width: 32,\n  height: 32,\n};\n\n// We scale up the canvas to avoid an irritating visual glitch when animating in Chrome.\nconst scaleRatio = 10;\n\nexport function useBlurhash(\n  blurhash: { uri?: string; width?: number; height?: number } | undefined | null,\n  punch: number = 1\n) {\n  punch = punch || 1;\n\n  const [uri, setUri] = useState<string | null>(null);\n\n  useEffect(() => {\n    let isCanceled = false;\n\n    if (!blurhash || !blurhash.uri || !isBlurhashString(blurhash.uri)) return;\n\n    const pixels = decode(\n      blurhash.uri,\n      blurhash?.width ?? DEFAULT_SIZE.width,\n      blurhash?.height ?? DEFAULT_SIZE.height,\n      punch\n    );\n\n    const canvas = document.createElement('canvas');\n    const upscaledCanvas = document.createElement('canvas');\n    canvas.width = blurhash?.width ?? DEFAULT_SIZE.width;\n    canvas.height = blurhash?.height ?? DEFAULT_SIZE.height;\n    upscaledCanvas.width = (blurhash?.width ?? DEFAULT_SIZE.width) * scaleRatio;\n    upscaledCanvas.height = (blurhash?.height ?? DEFAULT_SIZE.height) * scaleRatio;\n    const context = canvas.getContext('2d');\n    if (!context) {\n      console.warn('Failed to decode blurhash');\n      return;\n    }\n    const imageData = context.createImageData(canvas.width, canvas.height);\n    imageData.data.set(pixels);\n    context.putImageData(imageData, 0, 0);\n    const upscaledContext = upscaledCanvas.getContext('2d');\n    if (!upscaledContext) {\n      console.warn('Failed to decode blurhash');\n      return;\n    }\n    upscaledContext.scale(scaleRatio, scaleRatio);\n    upscaledContext.drawImage(canvas, 0, 0);\n    upscaledCanvas.toBlob((blob) => {\n      if (!isCanceled) {\n        setUri((oldUrl) => {\n          if (oldUrl) {\n            URL.revokeObjectURL(oldUrl);\n          }\n          return blob ? URL.createObjectURL(blob) : oldUrl;\n        });\n      }\n    });\n\n    return function cleanupBlurhash() {\n      isCanceled = true;\n      setUri((oldUrl) => {\n        if (oldUrl) {\n          URL.revokeObjectURL(oldUrl);\n        }\n        return null;\n      });\n    };\n  }, [blurhash?.uri, blurhash?.height, blurhash?.width, punch]);\n  return useMemo(() => (uri ? { uri } : null), [uri]);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}